<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lock Calendar Protocol - Master AI</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel (for JSX) -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- html2canvas -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;800&family=Noto+Sans+TC:wght@400;500;700;900&display=swap');
        
        body { font-family: 'Noto Sans TC', sans-serif; }
        .font-mono { font-family: 'JetBrains Mono', monospace; }

        /* Animations */
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .animate-fade-in { animation: fadeIn 0.8s ease-out forwards; }
        .animate-slide-up { animation: slideUp 0.6s ease-out forwards; }
        
        /* Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #1c1917; }
        ::-webkit-scrollbar-thumb { background: #44403c; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #57534e; }
    </style>
</head>
<body class="bg-stone-950 text-stone-200">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- ICONS ---
        const IconBase = ({ d, className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>{d}</svg>
        );
        const Lock = (p) => <IconBase {...p} d={<><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></>} />;
        const Key = (p) => <IconBase {...p} d={<><path d="m21 2-2 2m-7.61 7.61a5.5 5.5 0 1 1-7.778 7.778 5.5 5.5 0 0 1 7.777-7.777zm0 0L15.5 7.5m0 0 3 3L22 7l-3-3m-3.5 3.5L19 4"></path></>} />;
        const CalendarIcon = (p) => <IconBase {...p} d={<><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></>} />;
        const ShieldAlert = (p) => <IconBase {...p} d={<><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line></>} />;
        const RefreshCcw = (p) => <IconBase {...p} d={<><path d="M3 2v6h6"></path><path d="M21 12A9 9 0 0 0 6 5.3L3 8"></path><path d="M21 22v-6h-6"></path><path d="M3 12a9 9 0 0 0 15 6.7l3-2.7"></path></>} />;
        const XIcon = (p) => <IconBase {...p} d={<><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></>} />;
        const Activity = (p) => <IconBase {...p} d={<><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline></>} />;
        const Download = (p) => <IconBase {...p} d={<><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></>} />;
        const Eye = (p) => <IconBase {...p} d={<><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle></>} />;
        const Zap = (p) => <IconBase {...p} d={<><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon></>} />;
        const Disc = (p) => <IconBase {...p} d={<><circle cx="12" cy="12" r="10"></circle><circle cx="12" cy="12" r="3"></circle></>} />;
        const Palette = (p) => <IconBase {...p} d={<><circle cx="13.5" cy="6.5" r=".5"></circle><circle cx="17.5" cy="10.5" r=".5"></circle><circle cx="8.5" cy="7.5" r=".5"></circle><circle cx="6.5" cy="12.5" r=".5"></circle><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z"></path></>} />;
        const Droplet = (p) => <IconBase {...p} d={<><path d="M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"></path></>} />;
        const Ghost = (p) => <IconBase {...p} d={<><path d="M9 22l1-2.5 2 2.5 2-2.5 2 2.5 1-2.5V9a7 7 0 0 0-7-7 7 7 0 0 0-7 7v10.5L9 22z"></path><path d="M9 9h.01"></path><path d="M15 9h.01"></path></>} />;
        const Flame = (p) => <IconBase {...p} d={<><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></>} />;
        const Anchor = (p) => <IconBase {...p} d={<><circle cx="12" cy="5" r="3"></circle><line x1="12" y1="22" x2="12" y2="8"></line><path d="M5 12H2a10 10 0 0 0 20 0h-3"></path></>} />;
        const Globe = (p) => <IconBase {...p} d={<><circle cx="12" cy="12" r="10"></circle><line x1="2" y1="12" x2="22" y2="12"></line><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path></>} />;
        const Ruler = (p) => <IconBase {...p} d={<><path d="M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0l12.6 12.6z"></path><line x1="14.5" y1="5.5" x2="18.5" y2="9.5"></line><line x1="10.5" y1="9.5" x2="14.5" y2="13.5"></line><line x1="6.5" y1="13.5" x2="10.5" y2="17.5"></line></>} />;
        const Headphones = (p) => <IconBase {...p} d={<><path d="M3 18v-6a9 9 0 0 1 18 0v6"></path><path d="M21 19a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3zM3 19a2 2 0 0 0 2 2h1a2 2 0 0 0 2-2v-3a2 2 0 0 0-2-2H3z"></path></>} />;
        const ChevronRight = (p) => <IconBase {...p} d={<><polyline points="9 18 15 12 9 6"></polyline></>} />;
        const Smile = (p) => <IconBase {...p} d={<><circle cx="12" cy="12" r="10"></circle><path d="M8 14s1.5 2 4 2 4-2 4-2"></path><line x1="9" y1="9" x2="9.01" y2="9"></line><line x1="15" y1="9" x2="15.01" y2="9"></line></>} />;

        // --- TRANSLATIONS (13 Languages) ---
        const TRANSLATIONS = {
          'zh-TW': {
            title: 'é–æ›†è¨ˆç•«', subtitle: 'PROTOCOL', version: 'MASTER AI v7.1',
            intro_title: 'æ­¡è¿ä¾†åˆ°ä½ çš„æ–°ç”Ÿæ´»',
            // Updated intro_desc to restore V1.0 text
            intro_desc: (accent) => (
                <span>
                    æˆ‘æ˜¯é€™è£¡çš„ç³»çµ±æŒ‡å°è€…ã€‚ä½ æ—¢ç„¶ä¾†åˆ°äº†é€™è£¡ï¼Œå°±ä»£è¡¨ä½ æ¸´æœ›æŸç¨®ç¨‹åº¦çš„<span className={accent}>æ§åˆ¶</span>èˆ‡<span className={accent}>å‰å¥ª</span>ã€‚
                    <br/><br/>
                    åœ¨é€™è£¡ï¼Œä½ ä¸éœ€è¦æ€è€ƒï¼Œåªéœ€è¦<span className="font-bold">åŸ·è¡Œ</span>ã€‚
                    é€™æ˜¯ä¸€å€‹ç‚ºæœŸ 30 å¤©çš„è²æ“é–è¨“ç·´è¨ˆç•«ã€‚æˆ‘å°‡æ ¹æ“šä½ çš„ç´ è³ªï¼Œç‚ºä½ é‡èº«æ‰“é€ é€™ä¸€å€‹æœˆçš„è¡Œäº‹æ›†ã€‚
                </span>
            ),
            btn_start: 'é–‹å§‹åˆ¶å®šè¨ˆç•«', step1_title: 'åŸºæœ¬è³‡æ–™', label_name: 'æš±ç¨± / ç¨±å‘¼ Â· Nickname', label_level: 'å¼·åº¦ç­‰ç´š Â· Intensity',
            label_date: 'è£½ä½œæœˆä»½ Â· Date', label_year: 'è¥¿å…ƒå¹´ Â· YYYY', label_month: 'æœˆä»½ Â· Month',
            step1_ratings_title: 'éƒ¨ä½èˆ‡ç¨‹åº¦æ¥å—åº¦ Â· Zones & Limits',
            label_nipples: 'ä¹³é ­é–‹ç™¼ Â· Nipples', label_anal: 'å¾Œåº­é©æ‡‰ Â· Anal', label_urethra: 'å°¿é“/æ’æ³„ Â· Urethra',
            label_pain: 'ç–¼ç—›å¿å— Â· Pain', label_humiliation: 'ç¾æ¥æ„Ÿ Â· Humiliation', label_edging: 'é‚Šç·£æ§å°„ Â· Edging',
            label_bondage: 'æŸç¸›/æ‹˜æŸ Â· Bondage', label_public: 'éœ²å‡º/é‡å¤– Â· Public', label_service: 'ä¾å¥‰/ä»»å‹™ Â· Service',
            label_sensory: 'æ„Ÿå®˜å‰å¥ª Â· Sensory',
            step1_theme_title: 'è¦–è¦ºä¸»é¡Œé¢¨æ ¼ Â· Visual Theme', btn_generate: 'ç”Ÿæˆé–æ›†è¨ˆç•« Â· Generate',
            step2_title: 'çš„å°ˆå±¬é–æ›†', btn_reset: 'é‡æ–°è©•ä¼°', btn_download: 'ä¸‹è¼‰é–æ›†', modal_day: 'DAY',
            footer_sign: 'I hereby surrender my control.\nSignature: __________________________', footer_approve: 'MASTER APPROVED',
            warn_title: 'è­¦å‘Šï¼šæˆäººå…§å®¹', 
            // Expanded warning text
            warn_text1: 'æœ¬ç¶²ç«™å…§å®¹æ¶µè“‹æˆäººè­°é¡Œã€BDSMï¼ˆç¶ç¸›èˆ‡èª¿æ•™ã€æ”¯é…èˆ‡è‡£æœã€æ–½è™èˆ‡å—è™ï¼‰ä»¥åŠè²æ“æ§åˆ¶ç­‰æƒ…ç¯€ã€‚æ‰€æœ‰å…§å®¹åƒ…ä¾›æˆäººå¨›æ¨‚èˆ‡å¹»æƒ³ä½¿ç”¨ã€‚', 
            warn_text2: 'ä¾æ“šã€Šå…’ç«¥åŠå°‘å¹´ç¦åˆ©èˆ‡æ¬Šç›Šä¿éšœæ³•ã€‹ç¬¬ 46 æ¢è¦å®šï¼Œæœªæ»¿ 18 æ­²ä¹‹å…’ç«¥åŠå°‘å¹´ä¸å¾—ç€è¦½æœ¬ç¶²ç«™å…§å®¹ã€‚é€²å…¥å³ä»£è¡¨æ‚¨å·²å¹´æ»¿ 18 æ­²ï¼Œä¸”åŒæ„è§€çœ‹æ­¤é¡å…§å®¹ã€‚', 
            warn_text3: 'æœ¬è¨ˆç•«ä¸­çš„æ‰€æœ‰æ´»å‹•æ‡‰åœ¨ã€Œå®‰å…¨ã€ç†æ™ºã€çŸ¥æƒ…åŒæ„ (SSC)ã€æˆ–ã€Œé¢¨éšªèªçŸ¥ä¸‹çš„çŸ¥æƒ…åŒæ„ (RACK)ã€åŸå‰‡ä¸‹é€²è¡Œã€‚è«‹é‡åŠ›è€Œç‚ºï¼Œè‹¥æœ‰èº«é«”ä¸é©è«‹ç«‹å³åœæ­¢ã€‚æœ¬ç¶²ç«™ä¸å°ä»»ä½•å¯¦éš›åŸ·è¡Œå¾Œæœè² è²¬ã€‚',
            warn_text4: 'è‹¥æ‚¨æœªæ»¿ 18 æ­²ï¼Œæˆ–æ‚¨æ‰€åœ¨åœ°å€æ³•å¾‹ç¦æ­¢æ­¤é¡å…§å®¹ï¼Œæˆ–è€…æ­¤é¡å…§å®¹æœƒè®“æ‚¨æ„Ÿåˆ°ä¸é©ï¼Œè«‹ç«‹å³é»æ“Šé›¢é–‹ã€‚',
            warn_leave: 'é›¢é–‹ (Leave)', warn_enter: 'æˆ‘å·²å¹´æ»¿ 18 æ­² (Enter)'
          },
          'en': { title: 'LOCK PROTOCOL', subtitle: 'SYSTEM', version: 'MASTER AI v7.1', intro_title: 'Welcome', intro_desc: (c) => <span>Obey.</span>, btn_start: 'Start', step1_title: 'Subject Data', label_name: 'Name', label_level: 'Level', label_date: 'Date', label_year: 'Year', label_month: 'Month', step1_ratings_title: 'Limits', label_nipples: 'Nipples', label_anal: 'Anal', label_urethra: 'Urethra', label_pain: 'Pain', label_humiliation: 'Humiliation', label_edging: 'Edging', label_bondage: 'Bondage', label_public: 'Public', label_service: 'Service', label_sensory: 'Sensory', step1_theme_title: 'Theme', btn_generate: 'Generate', step2_title: ' Calendar', btn_reset: 'Reset', btn_download: 'Download', footer_sign: 'I surrender.', footer_approve: 'APPROVED', warn_title: '18+ ONLY', warn_text1: 'Adult Content.', warn_text2: 'Must be 18+.', warn_text3: 'Leave if under 18.', warn_text4: 'Safe, Sane, Consensual.', warn_leave: 'Leave', warn_enter: 'Enter' },
          'jp': { title: 'è²æ“ç®¡ç†è¨ˆç”»', subtitle: 'PROTOCOL', version: 'MASTER AI v7.1', intro_title: 'ã‚ˆã†ã“ã', intro_desc: (c) => <span>æœå¾“ã›ã‚ˆã€‚</span>, btn_start: 'é–‹å§‹', step1_title: 'åŸºæœ¬ãƒ‡ãƒ¼ã‚¿', label_name: 'åå‰', label_level: 'å¼·åº¦', label_date: 'æ—¥ä»˜', label_year: 'å¹´', label_month: 'æœˆ', step1_ratings_title: 'é–‹ç™ºéƒ¨ä½', label_nipples: 'ä¹³é¦–', label_anal: 'ã‚¢ãƒŠãƒ«', label_urethra: 'å°¿é“', label_pain: 'è‹¦ç—›', label_humiliation: 'ç¾æ¥', label_edging: 'å¯¸æ­¢ã‚', label_bondage: 'æ‹˜æŸ', label_public: 'éœ²å‡º', label_service: 'å¥‰ä»•', label_sensory: 'æ„Ÿè¦šé®æ–­', step1_theme_title: 'ãƒ†ãƒ¼ãƒ', btn_generate: 'ç”Ÿæˆ', step2_title: 'ã®è¨ˆç”»', btn_reset: 'å†è¨­å®š', btn_download: 'ä¿å­˜', footer_sign: 'é™ä¼ã—ã¾ã™ã€‚', footer_approve: 'æ‰¿èªæ¸ˆ', warn_title: 'R-18', warn_text1: 'æˆäººå‘ã‘ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã€‚', warn_text2: '18æ­³æœªæº€ç¦æ­¢ã€‚', warn_text3: 'é€€å‡ºã—ã¦ãã ã•ã„ã€‚', warn_text4: 'è‡ªå·±è²¬ä»»ã§ãŠé¡˜ã„ã—ã¾ã™ã€‚', warn_leave: 'é€€å‡º', warn_enter: 'å…¥å ´' },
          'kr': { title: 'ì •ì¡° ê´€ë¦¬', btn_start: 'ì‹œì‘', step1_title: 'ì •ë³´', label_name: 'ì´ë¦„', label_level: 'ë ˆë²¨', label_date: 'ë‚ ì§œ', label_year: 'ë…„', label_month: 'ì›”', step1_ratings_title: 'ì„¤ì •', label_nipples: 'ìœ ë‘', label_anal: 'ì• ë„', label_urethra: 'ìš”ë„', label_pain: 'ê³ í†µ', label_humiliation: 'ìˆ˜ì¹˜', label_edging: 'ì—ì§•', label_bondage: 'ì†ë°•', label_public: 'ë…¸ì¶œ', label_service: 'ë´‰ì‚¬', label_sensory: 'ê°ê°', step1_theme_title: 'í…Œë§ˆ', btn_generate: 'ìƒì„±', step2_title: 'ì˜ ë‹¬ë ¥', btn_reset: 'ì¬ì„¤ì •', btn_download: 'ë‹¤ìš´ë¡œë“œ', warn_title: '19ì„¸ ë¯¸ë§Œ ê¸ˆì§€', warn_leave: 'ë‚˜ê°€ê¸°', warn_enter: 'ì…ì¥' },
          'de': { title: 'KEUSCHHEIT', btn_start: 'Start', step1_title: 'Daten', label_name: 'Name', label_level: 'Level', label_date: 'Datum', label_year: 'Jahr', label_month: 'Monat', step1_ratings_title: 'Limits', label_nipples: 'Nippel', label_anal: 'Anal', label_urethra: 'HarnrÃ¶hre', label_pain: 'Schmerz', label_humiliation: 'DemÃ¼tigung', label_edging: 'Edging', label_bondage: 'Fesselung', label_public: 'Ã–ffentlich', label_service: 'Dienst', label_sensory: 'Sensorik', step1_theme_title: 'Thema', btn_generate: 'Generieren', step2_title: ' Kalender', btn_reset: 'Reset', btn_download: 'Download', warn_title: 'AB 18', warn_leave: 'Verlassen', warn_enter: 'Eintreten' },
          'es': { title: 'PROTOCOLO', btn_start: 'Inicio', step1_title: 'Datos', label_name: 'Nombre', label_level: 'Nivel', label_date: 'Fecha', label_year: 'AÃ±o', label_month: 'Mes', step1_ratings_title: 'LÃ­mites', label_nipples: 'Pezones', label_anal: 'Anal', label_urethra: 'Uretra', label_pain: 'Dolor', label_humiliation: 'HumillaciÃ³n', label_edging: 'Edging', label_bondage: 'Bondage', label_public: 'PÃºblico', label_service: 'Servicio', label_sensory: 'Sensorial', step1_theme_title: 'Tema', btn_generate: 'Generar', step2_title: ' Calendario', btn_reset: 'Reset', btn_download: 'Descargar', warn_title: '+18', warn_leave: 'Salir', warn_enter: 'Entrar' },
          'fr': { title: 'PROTOCOLE', btn_start: 'DÃ©but', step1_title: 'DonnÃ©es', label_name: 'Nom', label_level: 'Niveau', label_date: 'Date', label_year: 'AnnÃ©e', label_month: 'Mois', step1_ratings_title: 'Limites', label_nipples: 'Mamelons', label_anal: 'Anal', label_urethra: 'UrÃ¨tre', label_pain: 'Douleur', label_humiliation: 'Humiliation', label_edging: 'Edging', label_bondage: 'Bondage', label_public: 'Public', label_service: 'Service', label_sensory: 'Sensoriel', step1_theme_title: 'ThÃ¨me', btn_generate: 'GÃ©nÃ©rer', step2_title: ' Calendrier', btn_reset: 'Reset', btn_download: 'TÃ©lÃ©charger', warn_title: '18+', warn_leave: 'Quitter', warn_enter: 'Entrer' },
          'ru': { title: 'ĞŸĞ ĞĞ¢ĞĞšĞĞ›', btn_start: 'Ğ¡Ñ‚Ğ°Ñ€Ñ‚', step1_title: 'Ğ”Ğ°Ğ½Ğ½Ñ‹Ğµ', label_name: 'Ğ˜Ğ¼Ñ', label_level: 'Ğ£Ñ€Ğ¾Ğ²ĞµĞ½ÑŒ', label_date: 'Ğ”Ğ°Ñ‚Ğ°', label_year: 'Ğ“Ğ¾Ğ´', label_month: 'ĞœĞµÑÑÑ†', step1_ratings_title: 'Ğ›Ğ¸Ğ¼Ğ¸Ñ‚Ñ‹', label_nipples: 'Ğ¡Ğ¾ÑĞºĞ¸', label_anal: 'ĞĞ½Ğ°Ğ»', label_urethra: 'Ğ£Ñ€ĞµÑ‚Ñ€Ğ°', label_pain: 'Ğ‘Ğ¾Ğ»ÑŒ', label_humiliation: 'Ğ£Ğ½Ğ¸Ğ¶ĞµĞ½Ğ¸Ğµ', label_edging: 'Ğ­Ğ´Ğ¶Ğ¸Ğ½Ğ³', label_bondage: 'Ğ‘Ğ¾Ğ½Ğ´Ğ°Ğ¶', label_public: 'ĞŸÑƒĞ±Ğ»Ğ¸Ñ‡Ğ½Ğ¾', label_service: 'Ğ¡Ğ»ÑƒĞ¶Ğ±Ğ°', label_sensory: 'Ğ¡ĞµĞ½ÑĞ¾Ñ€Ğ¸ĞºĞ°', step1_theme_title: 'Ğ¢ĞµĞ¼Ğ°', btn_generate: 'Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ', step2_title: ' ĞšĞ°Ğ»ĞµĞ½Ğ´Ğ°Ñ€ÑŒ', btn_reset: 'Ğ¡Ğ±Ñ€Ğ¾Ñ', btn_download: 'Ğ¡ĞºĞ°Ñ‡Ğ°Ñ‚ÑŒ', warn_title: '18+', warn_leave: 'Ğ’Ñ‹Ñ…Ğ¾Ğ´', warn_enter: 'Ğ’Ñ…Ğ¾Ğ´' },
          'it': { title: 'PROTOCOLLO', btn_start: 'Inizio', step1_title: 'Dati', label_name: 'Nome', label_level: 'Livello', label_date: 'Data', label_year: 'Anno', label_month: 'Mese', step1_ratings_title: 'Limiti', label_nipples: 'Capezzoli', label_anal: 'Anale', label_urethra: 'Uretra', label_pain: 'Dolore', label_humiliation: 'Umiliazione', label_edging: 'Edging', label_bondage: 'Bondage', label_public: 'Pubblico', label_service: 'Servizio', label_sensory: 'Sensoriale', step1_theme_title: 'Tema', btn_generate: 'Generare', step2_title: ' Calendario', btn_reset: 'Reset', btn_download: 'Scarica', warn_title: '18+', warn_leave: 'Esci', warn_enter: 'Entra' },
          'pt': { title: 'PROTOCOLO', btn_start: 'InÃ­cio', step1_title: 'Dados', label_name: 'Nome', label_level: 'NÃ­vel', label_date: 'Data', label_year: 'Ano', label_month: 'MÃªs', step1_ratings_title: 'Limites', label_nipples: 'Mamilos', label_anal: 'Anal', label_urethra: 'Uretra', label_pain: 'Dor', label_humiliation: 'HumilhaÃ§Ã£o', label_edging: 'Edging', label_bondage: 'Bondage', label_public: 'PÃºblico', label_service: 'ServiÃ§o', label_sensory: 'Sensorial', step1_theme_title: 'Tema', btn_generate: 'Gerar', step2_title: ' CalendÃ¡rio', btn_reset: 'Reset', btn_download: 'Baixar', warn_title: '18+', warn_leave: 'Sair', warn_enter: 'Entrar' },
          'th': { title: 'à¹‚à¸›à¸£à¹‚à¸•à¸„à¸­à¸¥', btn_start: 'à¹€à¸£à¸´à¹ˆà¸¡', step1_title: 'à¸‚à¹‰à¸­à¸¡à¸¹à¸¥', label_name: 'à¸Šà¸·à¹ˆà¸­', label_level: 'à¸£à¸°à¸”à¸±à¸š', label_date: 'à¸§à¸±à¸™à¸—à¸µà¹ˆ', label_year: 'à¸›à¸µ', label_month: 'à¹€à¸”à¸·à¸­à¸™', step1_ratings_title: 'à¸‚à¸µà¸”à¸ˆà¸³à¸à¸±à¸”', label_nipples: 'à¸«à¸±à¸§à¸™à¸¡', label_anal: 'à¸—à¸§à¸²à¸£à¸«à¸™à¸±à¸', label_urethra: 'à¸—à¹ˆà¸­à¸›à¸±à¸ªà¸ªà¸²à¸§à¸°', label_pain: 'à¸„à¸§à¸²à¸¡à¹€à¸ˆà¹‡à¸šà¸›à¸§à¸”', label_humiliation: 'à¸„à¸§à¸²à¸¡à¸­à¸±à¸›à¸¢à¸¨', label_edging: 'à¹€à¸­à¸ˆà¸ˆà¸´à¹‰à¸‡', label_bondage: 'à¸à¸±à¸™à¸˜à¸™à¸²à¸à¸²à¸£', label_public: 'à¸ªà¸²à¸˜à¸²à¸£à¸“à¸°', label_service: 'à¸šà¸£à¸´à¸à¸²à¸£', label_sensory: 'à¸›à¸£à¸°à¸ªà¸²à¸—à¸ªà¸±à¸¡à¸œà¸±à¸ª', step1_theme_title: 'à¸˜à¸µà¸¡', btn_generate: 'à¸ªà¸£à¹‰à¸²à¸‡', step2_title: ' à¸›à¸à¸´à¸—à¸´à¸™', btn_reset: 'à¸£à¸µà¹€à¸‹à¹‡à¸•', btn_download: 'à¸”à¸²à¸§à¸™à¹Œà¹‚à¸«à¸¥à¸”', warn_title: '18+', warn_leave: 'à¸­à¸­à¸', warn_enter: 'à¹€à¸‚à¹‰à¸²' },
          'vi': { title: 'GIAO THá»¨C', btn_start: 'Báº¯t Ä‘áº§u', step1_title: 'Dá»¯ liá»‡u', label_name: 'TÃªn', label_level: 'Cáº¥p Ä‘á»™', label_date: 'NgÃ y', label_year: 'NÄƒm', label_month: 'ThÃ¡ng', step1_ratings_title: 'Giá»›i háº¡n', label_nipples: 'NÃºm vÃº', label_anal: 'Háº­u mÃ´n', label_urethra: 'Niá»‡u Ä‘áº¡o', label_pain: 'Äau Ä‘á»›n', label_humiliation: 'Sá»‰ nhá»¥c', label_edging: 'Edging', label_bondage: 'TrÃ³i buá»™c', label_public: 'CÃ´ng cá»™ng', label_service: 'Phá»¥c vá»¥', label_sensory: 'Cáº£m giÃ¡c', step1_theme_title: 'Chá»§ Ä‘á»', btn_generate: 'Táº¡o', step2_title: ' Lá»‹ch', btn_reset: 'Äáº·t láº¡i', btn_download: 'Táº£i xuá»‘ng', warn_title: '18+', warn_leave: 'ThoÃ¡t', warn_enter: 'VÃ o' },
          'id': { title: 'PROTOKOL', btn_start: 'Mulai', step1_title: 'Data', label_name: 'Nama', label_level: 'Level', label_date: 'Tanggal', label_year: 'Tahun', label_month: 'Bulan', step1_ratings_title: 'Batas', label_nipples: 'Puting', label_anal: 'Anal', label_urethra: 'Uretra', label_pain: 'Sakit', label_humiliation: 'Penghinaan', label_edging: 'Edging', label_bondage: 'Bondage', label_public: 'Publik', label_service: 'Layanan', label_sensory: 'Sensorik', step1_theme_title: 'Tema', btn_generate: 'Hasilkan', step2_title: ' Kalender', btn_reset: 'Reset', btn_download: 'Unduh', warn_title: '18+', warn_leave: 'Keluar', warn_enter: 'Masuk' }
        };

        // --- MASSIVE TASK DATABASE v7.0 (400+ ITEMS) ---
        
        const GENERATE_DB = () => {
            const db = [];
            
            // --- GENERAL (50+) ---
            const gen_soft = [
                "å…¨å¤©ä½©æˆ´ï¼šä»Šå¤©åªéœ€ç¿’æ…£å®ƒçš„å­˜åœ¨ï¼Œæ„Ÿå—å®ƒçš„é‡é‡ã€‚", "é¡å‰æª¢è¦–ï¼šå…¨è£¸åœ¨é¡å­å‰è§€å¯Ÿè‡ªå·±è¢«é–ä½çš„æ¨£å­ 5 åˆ†é˜ã€‚", "è§¸æ‘¸ç¦æ­¢ï¼šä»Šå¤©é™¤äº†æ¸…æ½”å¤–ï¼Œç¦æ­¢ç”¨æ‰‹è§¸ç¢°ç± å­ã€‚", 
                "æ—©å®‰å„€å¼ï¼šèµ·åºŠå¾Œç«‹åˆ»æª¢æŸ¥é–å…·ï¼Œå°é¡å­èªªã€æˆ‘æ˜¯é–çš„å¥´éš¸ã€ã€‚", "æ™šå®‰ç¢ºèªï¼šç¡å‰æª¢æŸ¥é–å…·æ˜¯å¦ç‰¢å›ºï¼Œä¸¦æ„Ÿè¬å®ƒçš„æ§åˆ¶ã€‚", "å–æ°´æé†’ï¼šæ¯æ¬¡å–æ°´æ™‚ï¼Œéƒ½è¦æé†’è‡ªå·±ä¸‹é¢æ˜¯è¢«é–ä½çš„ã€‚",
                "ç´”æ½”é£²é£Ÿï¼šä»Šå¤©åªåƒæ¸…æ·¡çš„é£Ÿç‰©ï¼Œä¿æŒèº«é«”æ½”æ·¨ã€‚", "åå§¿å°ä¾¿ï¼šå¾ä»Šå¤©é–‹å§‹ï¼Œåªèƒ½åè‘—å¦‚å»ï¼Œç„¡è«–ç’°å¢ƒã€‚", "ç± å…·å°è©±ï¼šå°è‘—ç± å­èªªä¸‰è²ã€è¬è¬ä½ ä¿è­·æˆ‘ã€ã€‚",
                "è¡Œèµ°æ„ŸçŸ¥ï¼šèµ°è·¯æ™‚å°ˆæ³¨æ„Ÿå—ç± å­èˆ‡å¤§è…¿çš„æ¯ä¸€æ¬¡æ‘©æ“¦ã€‚", "æŸç¸›å†¥æƒ³ï¼šéœå 10 åˆ†é˜ï¼Œå°‡æ„è­˜å®Œå…¨é›†ä¸­åœ¨é–çš„å†°å†·æ„Ÿä¸Šã€‚", "çµ•å°æœå¾æ—¥ï¼šä»Šå¤©å°ä»»ä½•äººçš„åˆç†è¦æ±‚éƒ½èªªã€å¥½ã€ã€‚",
                "å…§è¡£æª¢è¦–ï¼šæª¢æŸ¥æ‰€æœ‰å…§è¤²ï¼Œä¸Ÿæ‰å¤ªé¬†çš„ï¼Œåªç•™èƒ½åŒ…è¦†ç± å­çš„ã€‚", "æ¸…æ½”æ—¥ï¼šç”¨ç‰™åˆ·ä»”ç´°æ¸…æ½”ç± å…·çš„æ¯ä¸€å€‹ç¸«éš™ã€‚", "è¨˜éŒ„å¿ƒæƒ…ï¼šå¯«ä¸‹ 50 å­—é—œæ–¼è¢«é–ä½çš„æ„Ÿå—ã€‚",
                "æ„Ÿè¬æ—¥ï¼šåœ¨å¿ƒè£¡æ„Ÿè¬é–å…·å¸¶ä¾†çš„å®‰å…¨æ„Ÿã€‚", "ç„¡æ…¾æ—¥ï¼šä»Šå¤©ç¦æ­¢ä»»ä½•å½¢å¼çš„æ€§å¹»æƒ³ã€‚", "å†·æ°´æ´—è‡‰ï¼šæ—©æ™šç”¨æ¥µå†°çš„æ°´æ´—è‡‰ï¼Œä¿æŒæ¸…é†’ã€‚",
                "é–é ­æª¢æŸ¥ï¼šä»”ç´°æª¢æŸ¥é–é ­èˆ‡é‘°åŒ™å­”æ˜¯å¦æœ‰é«’æ±¡ã€‚", "å®Œæ•´æ€§æª¢æŸ¥ï¼šç¢ºèªçš®è†šæ²’æœ‰å› ç‚ºç± å­è€Œå—å‚·ã€‚"
            ];
            const gen_med = [
                "ç¡çœ è¨“ç·´ï¼šä»Šæ™šå¿…é ˆä½©æˆ´è‘—å…¥ç¡ï¼Œä¸å…è¨±åŠå¤œå·å·è§£é–‹ã€‚", "ç„¡å…§è¤²æ—¥ï¼šä»Šå¤©åœ¨å®¶ä¸ç©¿å…§è¤²ï¼Œåªç©¿å¤–è¤²æ„Ÿå—ç± å­çš„æ‘©æ“¦ã€‚", "å†·æ°´æ¾¡ï¼šä½©æˆ´è‘—é–é€²è¡Œ 5 åˆ†é˜å†·æ°´æ·‹æµ´ï¼Œä¿æŒå†·éœã€‚",
                "åå§¿ç”Ÿæ´»ï¼šä»Šå¤©åœ¨å®¶ç„¡è«–åšä»€éº¼ï¼Œç›¡é‡ä¿æŒåå§¿æˆ–è·ªå§¿ã€‚", "ç«™ç«‹è¾¦å…¬ï¼šè‹¥ç’°å¢ƒå…è¨±ï¼Œç«™ç«‹å·¥ä½œæˆ–ä¸Šç¶² 1 å°æ™‚ï¼Œæ„Ÿå—é‡åŠ›ã€‚", "ç·Šèº«è¤²æ—¥ï¼šç©¿ä¸Šæœ€ç·Šçš„ç‰›ä»”è¤²æˆ–å…§è¤²ï¼Œå‹’ç·Šç± å­ä¸€æ•´å¤©ã€‚",
                "å†°å¡Šé™æº«ï¼šç”¨å†°å¡Šåœ¨ç± å­è¡¨é¢æ»‘å‹•ï¼Œç›´åˆ°å®Œå…¨èåŒ–ã€‚", "ç¦æ­¢ç¿¹è…³ï¼šæ•´å¤©åè‘—æ™‚é›™è…¿ä½µæ”ï¼Œä¸å‡†ç¿¹äºŒéƒè…¿ã€‚", "åªç©¿åœè£™ï¼šåœ¨å®¶åšå®¶äº‹æ™‚ï¼Œåªç©¿åœè£™ï¼ˆå…§è¤²å¯é¸ï¼‰ï¼Œæ„Ÿå—æ¶¼æ„ã€‚",
                "ç¦æ…¾å®£å‘Šï¼šå°è‘—é¡å­å¤§è²èªªä¸‰æ¬¡ã€æˆ‘ä¸éœ€è¦é«˜æ½®ã€ã€‚", "åœ°æ¿æ™‚é–“ï¼šä»Šå¤©åœ¨å®¶ä¸å‡†åæ²™ç™¼ï¼Œåªèƒ½ååœ°æ¿ã€‚", "ç¡å‰ç½°ç«™ï¼šç¡å‰é¢å°ç‰†å£ç½°ç«™ 15 åˆ†é˜ï¼Œåçœä»Šæ—¥ã€‚",
                "æ—©èµ·æ‡²ç½°ï¼šæ¯”å¹³å¸¸æ—©èµ· 30 åˆ†é˜ï¼Œè·ªåå†¥æƒ³ã€‚", "ç¦é£Ÿé›¶é£Ÿï¼šä»Šå¤©é™¤äº†æ­£é¤ï¼Œç¦æ­¢åƒä»»ä½•é›¶é£Ÿã€‚", "ç¶²è·¯æˆ’æ–·ï¼šå›å®¶å¾Œç¦æ­¢ä½¿ç”¨ç¤¾ç¾¤è»Ÿé«”ï¼Œåªèƒ½é¢å°è‡ªå·±ã€‚"
            ];
            const gen_hard = [
                "24å°æ™‚æ¥µé™ï¼šå®Œå…¨å¿½è¦–å®ƒçš„å­˜åœ¨ï¼Œé€²è¡Œé«˜å¼·åº¦æœ‰æ°§é‹å‹•ã€‚", "éµè¤²åˆ‘ç½°ï¼šç¡è¦ºæ™‚ç©¿è‘—ç‰›ä»”è¤²ï¼Œé™åˆ¶ç¿»èº«èˆ‡æ´»å‹•ã€‚", "çµ•å°ç¦è§¸ï¼šé›™æ‰‹æˆ´ä¸Šé˜²æŠ“æ‰‹å¥—ï¼ˆæˆ–åšè¥ªå­ï¼‰2 å°æ™‚ã€‚",
                "æ¥µé™é‹å‹•ï¼šä½©æˆ´è‘—é–é€²è¡Œ 100 ä¸‹é–‹åˆè·³ã€‚", "é•·æ™‚é–“è·ªå§¿ï¼šåœ¨ç¡¬åœ°æ¿ä¸Šè·ªå 30 åˆ†é˜ï¼Œä¸å‡†ç§»å‹•ã€‚", "æˆ¶å¤–æ„ŸçŸ¥ï¼šåœ¨æˆ¶å¤–æ‰¾ä¸€å€‹æ²’äººçš„åœ°æ–¹ï¼Œéš”è‘—è¤²å­æ’«æ‘¸ç± å­ã€‚",
                "å†°æ¡¶æŒ‘æˆ°ï¼šå°‡ä¸‹åŠèº«æµ¸æ³¡åœ¨å†°æ¡¶ä¸­ 1 åˆ†é˜ã€‚", "çµ•å°æ²‰é»˜ï¼šåœ¨å®¶ä¸­ä¿æŒ 2 å°æ™‚çš„çµ•å°æ²‰é»˜ã€‚", "è’™çœ¼ç”Ÿæ´»ï¼šæˆ´ä¸Šçœ¼ç½©ç”Ÿæ´» 1 å°æ™‚ï¼ˆæ³¨æ„å®‰å…¨ï¼‰ã€‚"
            ];

            // --- NIPPLES (30+) ---
            const nip_tasks = [
                {t:"æ•æ„Ÿå–šé†’ï¼šä½©æˆ´é–å…·æ™‚ï¼Œç”¨æ‰‹æŒ‡æä½ä¹³é ­è½‰åœˆå„ 100 ä¸‹ã€‚", i:"soft"}, {t:"å†°å¡Šåˆºæ¿€ï¼šç”¨å†°å¡Šåœ¨ä¹³é ­ä¸Šç•«åœˆç›´åˆ°èåŒ–ã€‚", i:"soft"}, {t:"ä¹³é ­æ¢³ç†ï¼šç”¨æ¢³å­è¼•è¼•æ¢³ç†ä¹³é ­éƒ¨ä½ã€‚", i:"soft"},
                {t:"å¤¾å­åˆ‘ç½°ï¼šä½¿ç”¨å¤¾å­å¤¾ä½ä¹³é ­æŒçºŒ 10 åˆ†é˜ï¼ŒæœŸé–“ä¸å¾—ç™¼å‡ºè²éŸ³ã€‚", i:"medium"}, {t:"æ‹‰æ‰¯è¨“ç·´ï¼šè¼•è¼•æ‹‰æ‰¯ä¹³é ­ 50 ä¸‹ï¼Œæ„Ÿå—ç—›èˆ‡ç™¢ã€‚", i:"medium"}, {t:"è¡£ç‰©æ‘©æ“¦ï¼šä¸ç©¿ä¸Šè¡£ï¼Œç©¿è‘—ç²—ç³™æè³ªçš„å¤–å¥—æ‘©æ“¦ä¹³é ­ 20 åˆ†é˜ã€‚", i:"medium"},
                {t:"å†·ç†±äº¤æ›¿ï¼šå…ˆç”¨ç†±æ¯›å·¾æ•·ï¼Œå†ç”¨å†°å¡Šåˆºæ¿€ä¹³é ­ï¼Œé‡è¤‡ 3 æ¬¡ã€‚", i:"medium"}, {t:"æ©¡çš®ç­‹å½ˆæ“Šï¼šç”¨æ©¡çš®ç­‹è¼•å½ˆä¹³é ­ 10 ä¸‹ã€‚", i:"medium"},
                {t:"è² é‡ç·´ç¿’ï¼šåœ¨ä¹³å¤¾ä¸Šæ›ä¸Šè¼•å¾®é‡ç‰©ï¼ˆå¦‚é‘°åŒ™ä¸²ï¼‰ç«™ç«‹ 5 åˆ†é˜ã€‚", i:"hard"}, {t:"å¼·åŠ›å¤¾æ“Šï¼šä½¿ç”¨å¼·åŠ›ç‡•å°¾å¤¾å¤¾ä½ä¹³é ­ 5 åˆ†é˜ã€‚", i:"hard"}, {t:"é•·æ™‚é–“å¤¾ï¼šä¹³å¤¾ä½©æˆ´æ™‚é–“å»¶é•·è‡³ 30 åˆ†é˜ã€‚", i:"hard"},
                {t:"ä¹³é ­è·ªå§¿ï¼šè·ªåœ¨åœ°ä¸Šï¼Œä¹³é ­å¤¾è‘—å¤¾å­ï¼Œä¿æŒä¸Šèº«æŒºç›´ã€‚", i:"hard"}, {t:"å†°ç«å¤¾ï¼šå¤¾å­å†°é®å¾Œå¤¾ä¸Šä¹³é ­ã€‚", i:"hard"}
            ];

            // --- ANAL (30+) ---
            const anal_tasks = [
                {t:"å¾Œåº­æ„ŸçŸ¥ï¼šåœ¨ç± ä¸­ç‹€æ…‹ä¸‹ï¼Œå˜—è©¦æ”¾å…¥ä¸€æ ¹æ‰‹æŒ‡æˆ–æ˜¯å°å‹å¡å­ï¼Œé©æ‡‰ 10 åˆ†é˜ã€‚", i:"medium"}, {t:"æ“´å¼µæº–å‚™ï¼šæŠ¹ä¸Šæ½¤æ»‘æ¶²ï¼Œå˜—è©¦æ”¾å…¥ä¸­æŒ‡ï¼Œä¿æŒ 5 åˆ†é˜ã€‚", i:"medium"},
                {t:"å†°ç«å¾Œåº­ï¼šç”¨æº«æ°´æ²–æ´—å¾Œåº­ï¼Œå†å˜—è©¦æ”¾å…¥å†°éçš„å¡å­ï¼ˆå°å¿ƒï¼‰ã€‚", i:"medium"}, {t:"æ‹¬ç´„è‚Œè¨“ç·´ï¼šå¤¾ç·Šå¾Œåº­ 5 ç§’å†æ”¾é¬†ï¼Œé‡è¤‡ 50 çµ„ã€‚", i:"medium"},
                {t:"æŒ‡éšªæ¢ç§˜ï¼šå˜—è©¦ç”¨å…©æ ¹æ‰‹æŒ‡æ“´å¼µå¾Œåº­ã€‚", i:"medium"}, {t:"ç•°ç‰©å……ç›ˆï¼šä½©æˆ´ä¸­å‹å¡å­é€²è¡Œæ—¥å¸¸æ´»å‹•ï¼ˆå¦‚åšå®¶äº‹ã€çœ‹æ›¸ï¼‰30 åˆ†é˜ã€‚", i:"hard"},
                {t:"é›™é‡é–å®šï¼šå‰é¢æˆ´ç± ï¼Œå¾Œé¢æˆ´å¡ï¼Œç¶­æŒ 1 å°æ™‚ã€‚", i:"hard"}, {t:"ç¡çœ å¡ï¼šå˜—è©¦ä½©æˆ´è¼ƒå°çš„å¡å­å…¥ç¡ï¼ˆè‹¥ä¸é©è«‹ç«‹å³åœæ­¢ï¼‰ã€‚", i:"hard"},
                {t:"æ’ä¾¿å¾Œå¡ï¼šæ’ä¾¿æ¸…æ½”å¾Œï¼Œç«‹åˆ»å¡å…¥å¡å­ä¿æŒç©ºè™›æ„Ÿæ¶ˆå¤±ã€‚", i:"hard"}, {t:"é•·æ™‚é–“æ“´å¼µï¼šä½©æˆ´ä¸­å‹å¡å­è§€çœ‹ä¸€éƒ¨é›»å½±ã€‚", i:"hard"},
                {t:"è¡Œèµ°è¨“ç·´ï¼šä½©æˆ´å¡å­åœ¨å®¶ä¸­å¿«èµ° 10 åˆ†é˜ã€‚", i:"hard"}
            ];

            // --- URETHRA (30+) ---
            const urethra_tasks = [
                {t:"åå§¿æ’æ³„ï¼šå¾ä»Šå¤©èµ·ï¼Œé€™ä¸€å€‹æœˆå…§ä½ åªèƒ½åƒå¥³ç”Ÿä¸€æ¨£åè‘—å°¿å°¿ã€‚", i:"soft"}, {t:"æ’å°¿è§€å¯Ÿï¼šæ’å°¿æ™‚ä»”ç´°è§€å¯Ÿå°¿æ¶²å¦‚ä½•æµéç± å­ã€‚", i:"soft"},
                {t:"é£²æ°´æ§åˆ¶ï¼šå¤§é‡é£²æ°´å¾Œå¿è€ 45 åˆ†é˜ï¼Œæ„Ÿå—è†€èƒ±èˆ‡é–å…·çš„é›™é‡å£“åŠ›ã€‚", i:"medium"}, {t:"ä¸­æ–·ç·´ç¿’ï¼šå°¿å°¿æ™‚å˜—è©¦ä¸­æ–· 3 æ¬¡ï¼Œæ„Ÿå—å°¿é“è¢«æ§åˆ¶ã€‚", i:"medium"},
                {t:"è§€è³æ’æ³„ï¼šå°è‘—é¡å­æ’æ³„ï¼Œè§€å¯Ÿå°¿æ¶²ç©¿éç± å­çš„æ¨£å­ã€‚", i:"medium"}, {t:"å®šæ™‚æ’æ³„ï¼šè¨­å®šé¬§é˜ï¼Œæ¯ 3 å°æ™‚æ‰å…è¨±å»ä¸€æ¬¡å»æ‰€ã€‚", i:"medium"},
                {t:"æ¥µé™å¿è€ï¼šæœ‰å°¿æ„å¾Œå†å¿è€ 30 åˆ†é˜æ‰èƒ½å»å»æ‰€ã€‚", i:"hard"}, {t:"æ†‹å°¿æ·±è¹²ï¼šåœ¨è†€èƒ±å……ç›ˆçš„ç‹€æ…‹ä¸‹åš 10 å€‹æ·±è¹²ï¼ˆå°å¿ƒå¤±ç¦ï¼‰ã€‚", i:"hard"},
                {t:"æ†‹å°¿å‹ƒèµ·ï¼šåœ¨æ†‹å°¿ç‹€æ…‹ä¸‹çœ‹è‰²æƒ…åœ–ç‰‡ï¼Œæ„Ÿå—é›™é‡å£“åŠ›ã€‚", i:"hard"}, {t:"ç½°ç«™æ†‹å°¿ï¼šæœ‰å°¿æ„å¾Œç½°ç«™ 15 åˆ†é˜æ‰èƒ½å»å»æ‰€ã€‚", i:"hard"}
            ];

            // --- PAIN (30+) ---
            const pain_tasks = [
                {t:"é«”èƒ½ç»ç¥­ï¼šå…¨è£¸æ·±è¹² 50 ä¸‹ï¼Œè®“ç± å­æ‹æ‰“ä½ çš„å¤§è…¿å…§å´ã€‚", i:"medium"}, {t:"æ‹æ‰“ç·´ç¿’ï¼šç”¨å°ºæˆ–æ¿å­æ‹æ‰“è‡€éƒ¨ 50 ä¸‹ï¼Œå¿…é ˆè½åˆ°æ¸…è„†è²éŸ¿ã€‚", i:"medium"},
                {t:"è·ªå§¿åçœï¼šè·ªåœ¨ç¡¬åœ°æ¿ä¸Š 20 åˆ†é˜ï¼Œé›™æ‰‹èƒŒå¾Œã€‚", i:"medium"}, {t:"å¤§è…¿å…§å´æï¼šç”¨æ‰‹æå¤§è…¿å…§å´çš„å«©è‚‰ 20 ä¸‹ã€‚", i:"medium"},
                {t:"å†°æ°´æµ¸æ³¡ï¼šå°‡ç± å­èˆ‡é™°å›Šæµ¸æ³¡åœ¨å†°æ°´ä¸­ 30 ç§’ã€‚", i:"medium"}, {t:"å½ˆåŠ›æ‡²ç½°ï¼šç”¨æ©¡çš®ç­‹æˆ–å½ˆæ“Šç± èº« 20 ä¸‹ï¼Œæ¯ä¸€è²éƒ½æ˜¯å°æ…¾æœ›çš„å‘Šè§£ã€‚", i:"hard"},
                {t:"å¤¾å­å¤¾å¤§è…¿ï¼šç”¨å¤¾å­å¤¾ä½å¤§è…¿å…§å´æ•æ„Ÿè‚‰ 5 åˆ†é˜ã€‚", i:"hard"}, {t:"çªä¸¸æ‹æ‰“ï¼šè¼•è¼•æ‹æ‰“çªä¸¸ 50 ä¸‹ï¼Œä¿æŒç± å­ä¸å‹•ã€‚", i:"hard"},
                {t:"è·ªå§¿è·³èºï¼šè·ªè‘—é€²è¡Œ 10 æ¬¡è·³èºï¼ˆè†è“‹è‘—åœ°è·³ï¼‰ï¼Œæ„Ÿå—éœ‡å‹•ç—›ã€‚", i:"hard"}, {t:"æ‰“è›‹å™¨ï¼šç”¨æ‰‹æŒ‡å½ˆæ“Šçªä¸¸ 20 ä¸‹ã€‚", i:"hard"},
                {t:"æå¤§è…¿ï¼šæ¯ç•¶æœ‰æ…¾æœ›æ™‚ï¼Œç”¨åŠ›æå¤§è…¿å…§å´ä¸€ä¸‹ã€‚", i:"hard"}
            ];

            // --- HUMILIATION (30+) ---
            const hum_tasks = [
                {t:"è‡ªæˆ‘è²¶ä½ï¼šåœ¨èº«ä¸Šç”¨å£ç´…å¯«ä¸‹ã€Property (è²¡ç”¢)ã€ï¼Œæ‹ç…§å­˜æª”ã€‚", i:"medium"}, {t:"å¯µç‰©è¦–è§’ï¼šä½©æˆ´è‘—é–åœ¨åœ°ä¸Šçˆ¬è¡Œ 10 åˆ†é˜ï¼Œåƒç‹—ä¸€æ¨£ã€‚", i:"medium"},
                {t:"å°é¡è‡ªç½µï¼šçœ‹è‘—é¡å­è£¡çš„ç± å­ï¼Œå¤§è²èªªå‡º 10 å€‹è‡ªå·±æ·«è•©çš„ç†ç”±ã€‚", i:"medium"}, {t:"é …åœˆä½©æˆ´ï¼šåœ¨å®¶æˆ´ä¸Šé …åœˆä¸€æ•´å¤©ï¼Œæé†’è‡ªå·±çš„èº«ä»½ã€‚", i:"medium"},
                {t:"æ‹æ”ç± ç…§ï¼šæ‹ä¸€å¼µç± å­çš„ç‰¹å¯«ï¼Œä¸éœ€è¦éœ²è‡‰ï¼Œå­˜ç‚ºæ‰‹æ©Ÿæ¡Œå¸ƒä¸€å¤©ã€‚", i:"medium"}, {t:"è¦–è¦ºç¾æ¥ï¼šç©¿è‘—èƒ½é€å‡ºé–å½¢ç‹€çš„è¤²å­å»å€’åƒåœ¾æˆ–è¶…å•†è²·æ°´ã€‚", i:"hard"},
                {t:"åƒåœ¾æ¡¶è¦–è§’ï¼šè·ªåœ¨åƒåœ¾æ¡¶æ—é€²é£Ÿä¸€é¤ã€‚", i:"hard"}, {t:"å£ç´…å¡—é´‰ï¼šç”¨å£ç´…å¡—æ»¿ç± å­ï¼Œç„¶å¾Œæˆ´è‘—å®ƒéä¸€å¤©ã€‚", i:"hard"},
                {t:"å ±æ•¸ç·´ç¿’ï¼šä¸€é‚Šè‡ªæ‰“å±è‚¡ä¸€é‚Šå¤§è²å ±æ•¸ã€æˆ‘æ˜¯è³¤ç‹—1ã€æˆ‘æ˜¯è³¤ç‹—2...ã€è‡³ 50ã€‚", i:"hard"}, {t:"è·ªå§¿å–æ°´ï¼šåƒç‹—ä¸€æ¨£ï¼Œä¸ç”¨æ‰‹ï¼Œç›´æ¥å¾ç¢—è£¡å–æ°´ã€‚", i:"hard"}
            ];

            // --- BONDAGE (30+) ---
            const bond_tasks = [
                {t:"ç¹©ç¸›éœåï¼šå°‡é›™æ‰‹åç¶åœ¨èƒŒå¾Œï¼Œè·ªå 20 åˆ†é˜ï¼Œä¸å‡†ç§»å‹•ã€‚", i:"medium"}, {t:"å£çƒé«”é©—ï¼šæˆ´ä¸Šå£çƒï¼ˆæˆ–å’¬ä½æ¯›å·¾ï¼‰30 åˆ†é˜ï¼Œåªèƒ½ç”¨é¼»å­å‘¼å¸ã€‚", i:"medium"},
                {t:"å–®æ‰‹ç”Ÿæ´»ï¼šå°‡æ…£ç”¨æ‰‹ç¶åœ¨èº«å¾Œï¼Œåªç”¨å¦ä¸€éš»æ‰‹ç”Ÿæ´» 2 å°æ™‚ã€‚", i:"medium"}, {t:"ä½µè…¿ç¸›ï¼šå°‡é›™è†èˆ‡è…³è¸ç¶åœ¨ä¸€èµ·ï¼Œè©¦è‘—åœ¨å®¶ç§»å‹• 30 åˆ†é˜ã€‚", i:"medium"},
                {t:"å››è‚¢å‰å¥ªï¼šç¡è¦ºæ™‚å¿…é ˆæˆ´ä¸Šçœ¼ç½©ä¸¦ç¨å¾®æŸç¸›é›™æ‰‹ï¼Œé«”é©—ç„¡åŠ©æ„Ÿã€‚", i:"hard"}, {t:"æœ¨ä¹ƒä¼Šï¼šç”¨ä¿é®®è†œæˆ–åºŠå–®å°‡è‡ªå·±ç·Šç·Šè£¹ä½ï¼Œéœèºº 20 åˆ†é˜ã€‚", i:"hard"},
                {t:"åç¶ç¡çœ ï¼šå˜—è©¦é›™æ‰‹åç¶ï¼ˆé¬†é¬†çš„ï¼‰å…¥ç¡ã€‚", i:"hard"}, {t:"é¾œç”²ç¸›ï¼š(è‹¥æœƒ) å˜—è©¦çµ¦è‡ªå·±ç¶ä¸Šé¾œç”²ç¸›ä¸¦ä½©æˆ´ç± å­ 1 å°æ™‚ã€‚", i:"hard"},
                {t:"å°å£ä»¤ï¼šç”¨è† å¸¶å°ä½å˜´å·´ 1 å°æ™‚ã€‚", i:"hard"}
            ];

            // --- PUBLIC (30+) ---
            const pub_tasks = [
                {t:"çœŸç©ºæ•£æ­¥ï¼šä¸ç©¿å…§è¤²ï¼Œåªç©¿å¯¬é¬†è¤²å­åœ¨ä½å®¶é™„è¿‘æ•£æ­¥ 10 åˆ†é˜ã€‚", i:"medium"}, {t:"æ¨“æ¢¯é–“å†’éšªï¼šåœ¨æ·±å¤œç¢ºèªç„¡äººçš„æƒ…æ³ä¸‹ï¼Œå»æ¨“æ¢¯é–“ç«™ç«‹ 3 åˆ†é˜ã€‚", i:"medium"},
                {t:"è»Šå…§éœ²å‡ºï¼šåœ¨è‡ªå·±çš„è»Šå…§ï¼ˆåœåœ¨éš±è”½è™•ï¼‰è„«ä¸‹è¤²å­è§€å¯Ÿç± å­ 5 åˆ†é˜ã€‚", i:"medium"}, {t:"ç·Šèº«é‹å‹•ï¼šç©¿è‘—ç·Šèº«é‹å‹•è¤²å»å…¬åœ’æ…¢è·‘ï¼Œæ„Ÿå—ç± å­çš„è¼ªå»“ã€‚", i:"medium"},
                {t:"é™½å°æ”¾é¢¨ï¼šåœ¨éš±å¯†çš„é™½å°æˆ–çª—é‚Šå…¨è£¸ä½©æˆ´é–å…·ç«™ç«‹ 5 åˆ†é˜ã€‚", i:"hard"}, {t:"è¶…å¸‚æŒ‘æˆ°ï¼šåœ¨è¶…å¸‚è³¼è²·ä¸€æ ¹é¦™è•‰æˆ–é»ƒç“œï¼Œæƒ³åƒå®ƒæ˜¯ç”¨ä¾†åšä»€éº¼çš„ã€‚", i:"hard"},
                {t:"å…¬å»æª¢è¦–ï¼šåœ¨å…¬å…±å»æ‰€çš„éš”é–“å…§ï¼Œæª¢æŸ¥ä¸¦æ¬£è³è‡ªå·±çš„é–å…·ã€‚", i:"hard"}, {t:"å¤§è†½å€’åƒåœ¾ï¼šåªç©¿ä¸€ä»¶é•·å¤§è¡£å»å€’åƒåœ¾ï¼ˆå…§è£¡å…¨è£¸+ç± å­ï¼‰ã€‚", i:"hard"}
            ];

            // --- SENSORY (30+) ---
            const sen_tasks = [
                {t:"é»‘æš—æ™šé¤ï¼šæˆ´ä¸Šçœ¼ç½©é€²é£Ÿæ™šé¤ï¼Œå…¨ç¨‹ä¸å¾—ç™¼å‡ºè²éŸ³ã€‚", i:"medium"}, {t:"è½è¦ºå‰å¥ªï¼šæˆ´ä¸Šé™å™ªè€³æ©Ÿæˆ–è€³å¡ 2 å°æ™‚ï¼Œå°ˆæ³¨æ–¼ä¸‹é«”çš„æŸç¸›æ„Ÿã€‚", i:"medium"},
                {t:"å†°å¡ŠéŠæˆ²ï¼šé–‰çœ¼ï¼Œéš¨æ©Ÿç”¨å†°å¡Šè§¸ç¢°èº«é«”ä¸åŒéƒ¨ä½ï¼Œä¸å‡†èº²é¿ã€‚", i:"medium"}, {t:"ç¾½æ¯›æ”ç™¢ï¼šç”¨ç¾½æ¯›æˆ–ç­†å°–è¼•æƒå…¨èº«æ•æ„Ÿå¸¶ï¼Œé™¤äº†ç± å­éƒ¨ä½ã€‚", i:"medium"},
                {t:"æ„Ÿå®˜éš”é›¢ï¼šçœ¼ç½©+è€³å¡ï¼Œåœ¨åºŠä¸Šéœèºº 30 åˆ†é˜ï¼Œåªèƒ½æ„Ÿå—ä¸‹é«”çš„æŸç¸›ã€‚", i:"hard"}, {t:"æº«å·®æ¾¡ï¼šç†±æ°´æ·‹æµ´å¾Œç¬é–“åˆ‡æ›å…¨å†·æ°´ï¼Œæ„Ÿå—èº«é«”çš„éœ‡é¡«ã€‚", i:"hard"},
                {t:"è’™çœ¼è§¸æ‘¸ï¼šè’™çœ¼å¾Œï¼Œç”¨ä¸åŒæè³ªï¼ˆçµ²ç¶¢ã€èœç“œå¸ƒï¼‰è§¸æ‘¸ç± å­ã€‚", i:"hard"}
            ];

            // --- SERVICE (30+) ---
            const srv_tasks = [
                {t:"ç± å…·æ¸…æ½”ï¼šç”¨ç‰™åˆ·ä»”ç´°æ¸…æ½”ç± å…·çš„æ¯ä¸€å€‹ç¸«éš™ï¼Œåƒå°å¾…è–ç‰©ä¸€æ¨£ã€‚", i:"soft"}, {t:"è·ªå§¿æ“¦åœ°ï¼šå…¨è£¸ä½©æˆ´é–å…·ï¼Œç”¨æŠ¹å¸ƒè·ªè‘—æ“¦æ‹­å®¶è£¡çš„åœ°æ¿ã€‚", i:"medium"},
                {t:"æ‰‹å¯«åˆç´„ï¼šæŠ„å¯«ã€æˆ‘è‡ªé¡˜å°‡æ§åˆ¶æ¬Šäº¤å‡ºã€50 éã€‚", i:"medium"}, {t:"æ•´ç†è–å£‡ï¼šæ•´ç†æ”¾ç½®æƒ…è¶£ç”¨å“æˆ–é–å…·é‘°åŒ™çš„åœ°æ–¹ï¼Œä¿æŒä¸€å¡µä¸æŸ“ã€‚", i:"medium"},
                {t:"ç‚ºä¸»äººå€’æ°´ï¼šè·ªè‘—å€’ä¸€æ¯æ°´ï¼Œæƒ³åƒå‘ˆçµ¦ä¸»äººã€‚", i:"medium"}, {t:"è¶³éƒ¨ä¾å¥‰ï¼šæƒ³åƒä¸»äººçš„è…³åœ¨é¢å‰ï¼Œé€²è¡Œç©ºæ°£èˆ”èˆèˆ‡æŒ‰æ‘© 10 åˆ†é˜ã€‚", i:"hard"},
                {t:"çµ•å°è·ªå§¿ï¼šåœ¨å®¶çœ‹é›»è¦–æˆ–æ»‘æ‰‹æ©Ÿæ™‚ï¼Œå¿…é ˆä¿æŒè·ªå§¿ 30 åˆ†é˜ã€‚", i:"hard"}, {t:"éµç›¤è·ªï¼š(è‹¥æœ‰èˆŠéµç›¤) è†è“‹è·ªåœ¨éµç›¤ä¸Š 5 åˆ†é˜ã€‚", i:"hard"}
            ];

            // Populate DB helper
            gen_soft.forEach(t => db.push({tags:['general'], intensity:'soft', text_zh:t}));
            gen_med.forEach(t => db.push({tags:['general'], intensity:'medium', text_zh:t}));
            gen_hard.forEach(t => db.push({tags:['general'], intensity:'hard', text_zh:t}));
            
            [...nip_tasks, ...anal_tasks, ...urethra_tasks, ...pain_tasks, ...hum_tasks, ...bond_tasks, ...pub_tasks, ...sen_tasks, ...srv_tasks].forEach(item => {
                let tag = "";
                if(nip_tasks.includes(item)) tag = 'nipples';
                if(anal_tasks.includes(item)) tag = 'anal';
                if(urethra_tasks.includes(item)) tag = 'urethra';
                if(pain_tasks.includes(item)) tag = 'pain';
                if(hum_tasks.includes(item)) tag = 'humiliation';
                if(bond_tasks.includes(item)) tag = 'bondage';
                if(pub_tasks.includes(item)) tag = 'public';
                if(sen_tasks.includes(item)) tag = 'sensory';
                if(srv_tasks.includes(item)) tag = 'service';
                db.push({tags:[tag], intensity:item.i, text_zh:item.t});
            });

            return db;
        };

        const TASKS_DB = GENERATE_DB();

        // --- 10 THEMES ---
        const THEMES = {
          clinical: { id: 'clinical', name: 'è‡¨åºŠå¯¦é©— (Clinical)', colors: { bg: 'bg-slate-50', text: 'text-slate-700', border: 'border-slate-300', accent: 'text-rose-600', accentBg: 'bg-rose-200', card: 'bg-white shadow-sm', cardHover: 'hover:border-rose-400 hover:shadow-md', modal: 'bg-white border-rose-500', button: 'bg-slate-800 hover:bg-slate-700' } },
          mono: { id: 'mono', name: 'æ¥µç°¡ (Mono)', colors: { bg: 'bg-white', text: 'text-black', border: 'border-black', accent: 'text-black', accentBg: 'bg-gray-200', card: 'bg-white border-2 border-black', cardHover: 'hover:bg-gray-50', modal: 'bg-white border-4 border-black', button: 'bg-black text-white hover:bg-gray-800' } },
          classic: { id: 'classic', name: 'ç¶“å…¸æ·é– (Classic)', colors: { bg: 'bg-stone-950', text: 'text-stone-200', border: 'border-stone-800', accent: 'text-red-600', accentBg: 'bg-red-900', card: 'bg-stone-900', cardHover: 'hover:border-stone-600', modal: 'bg-stone-900 border-red-900', button: 'bg-red-800 hover:bg-red-700' } },
          cyber: { id: 'cyber', name: 'è³½åšç›£ç¦ (Cyber)', colors: { bg: 'bg-black', text: 'text-cyan-50', border: 'border-cyan-900', accent: 'text-fuchsia-500', accentBg: 'bg-fuchsia-900', card: 'bg-slate-900', cardHover: 'hover:border-fuchsia-500 hover:shadow-[0_0_15px_rgba(217,70,239,0.3)]', modal: 'bg-black border-fuchsia-600', button: 'bg-fuchsia-700 hover:bg-fuchsia-600' } },
          industrial: { id: 'industrial', name: 'é‡å·¥æ¥­ (Industrial)', colors: { bg: 'bg-neutral-900', text: 'text-orange-100', border: 'border-orange-900/50', accent: 'text-orange-500', accentBg: 'bg-orange-900', card: 'bg-neutral-800', cardHover: 'hover:border-orange-500', modal: 'bg-neutral-800 border-orange-600', button: 'bg-orange-700 hover:bg-orange-600' } },
          royal: { id: 'royal', name: 'çš‡å®¤èª¿æ•™ (Royal)', colors: { bg: 'bg-slate-900', text: 'text-slate-200', border: 'border-yellow-900/30', accent: 'text-yellow-500', accentBg: 'bg-yellow-900/40', card: 'bg-slate-800', cardHover: 'hover:border-yellow-500/50', modal: 'bg-slate-800 border-yellow-600', button: 'bg-indigo-900 hover:bg-indigo-800' } },
          vampire: { id: 'vampire', name: 'å¸è¡€é¬¼ (Vampire)', colors: { bg: 'bg-black', text: 'text-red-50', border: 'border-red-900', accent: 'text-red-600', accentBg: 'bg-red-950', card: 'bg-black', cardHover: 'hover:border-red-600 hover:shadow-[0_0_20px_rgba(220,38,38,0.4)]', modal: 'bg-black border-red-800', button: 'bg-red-900 hover:bg-red-800' } },
          ocean: { id: 'ocean', name: 'æ·±æµ· (Ocean)', colors: { bg: 'bg-sky-950', text: 'text-sky-100', border: 'border-sky-800', accent: 'text-cyan-400', accentBg: 'bg-sky-900', card: 'bg-sky-900/50', cardHover: 'hover:border-cyan-400', modal: 'bg-sky-900 border-cyan-500', button: 'bg-sky-700 hover:bg-sky-600' } },
          nature: { id: 'nature', name: 'æ£®æ— (Nature)', colors: { bg: 'bg-stone-900', text: 'text-emerald-100', border: 'border-emerald-900', accent: 'text-emerald-500', accentBg: 'bg-emerald-900', card: 'bg-stone-800', cardHover: 'hover:border-emerald-500', modal: 'bg-stone-800 border-emerald-600', button: 'bg-emerald-800 hover:bg-emerald-700' } },
          luxury: { id: 'luxury', name: 'å¥¢è¯ (Luxury)', colors: { bg: 'bg-neutral-900', text: 'text-amber-100', border: 'border-amber-700/50', accent: 'text-amber-400', accentBg: 'bg-amber-900/30', card: 'bg-neutral-800', cardHover: 'hover:border-amber-400 hover:shadow-[0_0_15px_rgba(251,191,36,0.2)]', modal: 'bg-neutral-800 border-amber-600', button: 'bg-amber-800 hover:bg-amber-700' } },
        };

        const LockCalendarPro = () => {
          // ... (State and useEffect unchanged) ...
          const [verified, setVerified] = useState(false);
          const [step, setStep] = useState(0); 
          const [selectedDay, setSelectedDay] = useState(null); 
          const exportRef = useRef(null); 
          const [libLoaded, setLibLoaded] = useState(false);
          const [lang, setLang] = useState('zh-TW');

          useEffect(() => {
            if(window.html2canvas) setLibLoaded(true);
          }, []);

          // Safe style for export node
          const exportBgStyle = { backgroundImage: `radial-gradient(circle at 50% 50%, currentColor 0%, transparent 50%)` };

          const now = new Date();
          const currentYear = now.getFullYear();
          const currentMonth = now.getMonth() + 1; 

          const [userData, setUserData] = useState({
            name: '', level: 'medium', year: currentYear, month: currentMonth, theme: 'classic',
            prefs: {
              nipples: 1, anal: 1, urethra: 1, pain: 1, humiliation: 1, edging: 1,
              bondage: 1, public: 1, service: 1, sensory: 1
            }
          });

          const [calendar, setCalendar] = useState([]);

          const currentTheme = THEMES[userData.theme].colors;
          const t = TRANSLATIONS[lang] || TRANSLATIONS['zh-TW']; 

          const handlePrefChange = (key, val) => setUserData(prev => ({ ...prev, prefs: { ...prev.prefs, [key]: val } }));

          const getTaskIcon = (tags, type) => {
            const props = { className: `w-full h-full opacity-20 ${currentTheme.text}` };
            if (type === 'start' || type === 'end') return <Lock {...props} className={`w-full h-full opacity-20 ${currentTheme.accent}`} />;
            if (type === 'check') return <ShieldAlert {...props} />;
            if (tags.includes('nipples')) return <Disc {...props} />;
            if (tags.includes('anal')) return <Activity {...props} />;
            if (tags.includes('urethra')) return <Droplet {...props} />;
            if (tags.includes('pain')) return <Zap {...props} />;
            if (tags.includes('humiliation')) return <Eye {...props} />;
            if (tags.includes('edging')) return <Flame {...props} />;
            if (tags.includes('mind')) return <Ghost {...props} />;
            if (tags.includes('bondage')) return <Anchor {...props} />;
            if (tags.includes('public')) return <Globe {...props} />;
            if (tags.includes('service')) return <Ruler {...props} />;
            if (tags.includes('sensory')) return <Headphones {...props} />;
            return <Smile {...props} />;
          };

          // Simplified text getter
          const getTaskText = (taskObj) => {
             return taskObj.text_zh; 
          };

          const generateProtocol = () => {
            const daysInMonth = new Date(userData.year, userData.month, 0).getDate();
            let firstDayIndex = new Date(userData.year, userData.month - 1, 1).getDay(); 
            let offset = firstDayIndex === 0 ? 6 : firstDayIndex - 1;

            let weightedPool = [];
            
            // Build Pool
            Object.entries(userData.prefs).forEach(([key, rating]) => {
              if (rating > 1) {
                const tagTasks = TASKS_DB.filter(t => t.tags.includes(key));
                for (let i = 0; i < rating; i++) {
                  weightedPool.push(...tagTasks);
                }
              }
            });

            // Always add General tasks
            const generalTasks = TASKS_DB.filter(t => t.tags.includes('general'));
            weightedPool.push(...generalTasks);
            weightedPool.push(...generalTasks);

            // Filter by intensity
            weightedPool = weightedPool.filter(task => {
              if (userData.level === 'soft') return task.intensity === 'soft';
              if (userData.level === 'medium') return task.intensity !== 'hard';
              return true;
            });

            // Shuffle
            const shuffledPool = [...weightedPool].sort(() => Math.random() - 0.5);

            // Strict Unique Selection
            const selectedTasks = [];
            const usedTexts = new Set();
            
            // 1. Try to fill from user prefs first
            for (const task of shuffledPool) {
              if (!usedTexts.has(task.text_zh)) {
                selectedTasks.push(task);
                usedTexts.add(task.text_zh);
              }
              if (selectedTasks.length >= daysInMonth) break;
            }

            // 2. If not enough, fill from UNUSED General tasks
            if (selectedTasks.length < daysInMonth) {
                const unusedGeneral = TASKS_DB.filter(t => t.tags.includes('general') && !usedTexts.has(t.text_zh));
                const extraTasks = unusedGeneral.sort(() => Math.random() - 0.5);
                for(const task of extraTasks) {
                    selectedTasks.push(task);
                    usedTexts.add(task.text_zh);
                    if (selectedTasks.length >= daysInMonth) break;
                }
            }

            // 3. Last resort: Allow repeats
            while (selectedTasks.length < daysInMonth) {
               selectedTasks.push(shuffledPool[Math.floor(Math.random() * shuffledPool.length)]);
            }

            const days = [];
            for (let k = 0; k < offset; k++) {
              days.push({ day: null, type: 'empty' });
            }

            const finalTaskOrder = selectedTasks.sort(() => Math.random() - 0.5);

            for (let i = 1; i <= daysInMonth; i++) {
              let taskObj = finalTaskOrder[i - 1]; 
              let type = "normal";
              days.push({ 
                day: i, 
                task: taskObj.text_zh, 
                tags: taskObj.tags || ['general'], 
                type 
              });
            }
            setCalendar(days);
            setStep(2);
          };

          const downloadImage = async () => {
            if (!exportRef.current || !window.html2canvas) { alert("Loading..."); return; }
            try {
              const canvas = await window.html2canvas(exportRef.current, {
                scale: 2, backgroundColor: userData.theme === 'clinical' || userData.theme === 'mono' ? '#ffffff' : '#0c0a09',
                useCORS: true, logging: false
              });
              const link = document.createElement('a');
              link.download = `LockCalendar_${userData.year}_${userData.month}.png`;
              link.href = canvas.toDataURL();
              link.click();
            } catch (err) { console.error(err); alert("Failed."); }
          };

          // --- RENDER ---
          if (!verified) {
            return (
              <div className="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-95 text-red-600 font-sans">
                <div className="bg-stone-900 border-2 border-red-800 p-8 rounded-lg max-w-md text-center shadow-[0_0_30px_rgba(220,38,38,0.3)]">
                  <div className="text-6xl mb-6 animate-pulse">ğŸ”</div>
                  <h1 className="text-3xl font-bold mb-4 tracking-widest uppercase">{t.warn_title}</h1>
                  <div className="text-stone-400 text-sm text-left mb-6 space-y-2 border-t border-b border-stone-700 py-4 overflow-y-auto max-h-[60vh]">
                    <p>{t.warn_text1}</p>
                    <br/>
                    <p>{t.warn_text2}</p>
                    <br/>
                    <p>{t.warn_text3}</p>
                    {t.warn_text4 && <><br/><p className="text-red-500 font-bold">{t.warn_text4}</p></>}
                  </div>
                  <div className="flex gap-4 justify-center">
                    <button onClick={() => window.location.href = 'https://www.google.com'} className="px-6 py-2 border border-stone-600 text-stone-400 hover:bg-stone-800 rounded transition-colors">{t.warn_leave}</button>
                    <button onClick={() => setVerified(true)} className="px-6 py-2 bg-red-900 text-white font-bold rounded hover:bg-red-700 hover:shadow-[0_0_15px_rgba(220,38,38,0.5)] transition-all">{t.warn_enter}</button>
                  </div>
                </div>
              </div>
            );
          }

          const RatingControl = ({ label, value, onChange, icon }) => (
            <div className={`${currentTheme.card} ${currentTheme.border} border p-4 rounded-lg flex flex-col gap-3 transition-colors`}>
              <div className={`flex items-center gap-2 font-bold ${currentTheme.text} opacity-90 text-sm md:text-base`}>
                {icon} {label}
              </div>
              <div className="flex justify-between items-center bg-black/20 rounded p-1">
                {[1, 2, 3, 4, 5].map(num => (
                  <button key={num} onClick={() => onChange(num)}
                    className={`w-8 h-8 rounded text-sm font-bold transition-all ${value === num ? `${currentTheme.button} text-white shadow-lg` : `${currentTheme.text} opacity-50 hover:opacity-100 hover:bg-white/10`}`}>
                    {num}
                  </button>
                ))}
              </div>
            </div>
          );

          return (
            <div className={`min-h-screen ${currentTheme.bg} ${currentTheme.text} font-sans pb-20 overflow-x-hidden transition-colors duration-500`}>
              {/* Header */}
              <header className={`backdrop-blur-md sticky top-0 z-40 border-b ${currentTheme.border} p-4 bg-black/20`}>
                <div className="max-w-4xl mx-auto flex justify-between items-center">
                  <div>
                    <div className={`flex items-center gap-2 ${currentTheme.accent}`}>
                        <Lock className="w-6 h-6" />
                        <span className={`font-black tracking-widest text-lg ${currentTheme.text}`}>{t.title} <span className="text-xs font-normal opacity-70">{t.subtitle}</span></span>
                    </div>
                    <div className="text-[10px] opacity-50 font-mono mt-1 ml-8">By @ARNO19450</div>
                  </div>
                  <div className="flex items-center gap-4">
                     <select value={lang} onChange={(e) => setLang(e.target.value)} className={`bg-transparent border ${currentTheme.border} text-xs p-1 rounded ${currentTheme.text} opacity-70 hover:opacity-100 focus:outline-none`}>
                       <option value="zh-TW">ç¹é«”ä¸­æ–‡</option>
                       <option value="en">English</option>
                       <option value="jp">æ—¥æœ¬èª</option>
                       <option value="kr">í•œêµ­ì–´</option>
                       <option value="de">Deutsch</option>
                       <option value="fr">FranÃ§ais</option>
                       <option value="es">EspaÃ±ol</option>
                       <option value="ru">Ğ ÑƒÑÑĞºĞ¸Ğ¹</option>
                       <option value="it">Italiano</option>
                       <option value="pt">PortuguÃªs</option>
                       <option value="th">à¹„à¸—à¸¢</option>
                       <option value="vi">Tiáº¿ng Viá»‡t</option>
                       <option value="id">Bahasa Indonesia</option>
                     </select>
                     <div className="text-xs opacity-50 font-mono hidden sm:block">{t.version}</div>
                  </div>
                </div>
              </header>

              {/* Main Content */}
              <main className="max-w-4xl mx-auto p-4 mt-8">
                {step === 0 && (
                  <div className="max-w-2xl mx-auto text-center space-y-8 animate-fade-in">
                    <div className={`w-24 h-24 rounded-full mx-auto flex items-center justify-center border-2 shadow-[0_0_30px_rgba(0,0,0,0.2)] ${currentTheme.card} ${currentTheme.border}`}>
                      <Key className={`w-10 h-10 ${currentTheme.accent}`} />
                    </div>
                    <div className="space-y-4"><h2 className="text-3xl font-bold">{t.intro_title}</h2><p className="opacity-70 leading-relaxed text-lg">{t.intro_desc(currentTheme.accent)}</p></div>
                    <button onClick={() => setStep(1)} className={`group relative px-8 py-4 ${currentTheme.card} font-bold tracking-widest overflow-hidden rounded border ${currentTheme.border} hover:border-current transition-all`}>
                      <span className={`relative z-10 flex items-center gap-2 ${currentTheme.accent}`}>{t.btn_start} <ChevronRight className="w-4 h-4 group-hover:translate-x-1 transition-transform"/></span>
                    </button>
                  </div>
                )}

                {step === 1 && (
                  <div className="max-w-2xl mx-auto space-y-6 animate-slide-up">
                    <div className={`${currentTheme.card} border ${currentTheme.border} p-6 rounded-lg`}>
                      <h3 className="text-xl font-bold mb-4 flex items-center gap-2"><Lock className="w-4 h-4"/> {t.step1_title}</h3>
                      <div className="space-y-4">
                        <div><label className="text-xs opacity-60 mb-1 block">{t.label_name}</label><input type="text" value={userData.name} onChange={e => setUserData({...userData, name: e.target.value})} className={`w-full bg-black/20 border ${currentTheme.border} rounded p-3 focus:outline-none focus:border-current`} placeholder="..." /></div>
                        <div><label className="text-xs opacity-60 mb-2 block">{t.label_level}</label><div className="grid grid-cols-3 gap-2">{['soft', 'medium', 'hard'].map(l => (<button key={l} onClick={() => setUserData({...userData, level: l})} className={`py-2 rounded border text-sm uppercase font-bold transition-all ${userData.level === l ? `${currentTheme.button} text-white border-transparent` : `bg-transparent ${currentTheme.border} opacity-60`}`}>{l}</button>))}</div></div>
                      </div>
                    </div>

                    <div className={`${currentTheme.card} border ${currentTheme.border} p-6 rounded-lg`}>
                       <h3 className="text-xl font-bold mb-4 flex items-center gap-2"><CalendarIcon className="w-4 h-4"/> {t.label_date}</h3>
                       <div className="grid grid-cols-2 gap-4">
                         <div><label className="text-xs opacity-60 mb-1 block">{t.label_year}</label><input type="number" value={userData.year} onChange={e => setUserData({...userData, year: parseInt(e.target.value)})} className={`w-full bg-black/20 border ${currentTheme.border} rounded p-3 focus:outline-none focus:border-current`} /></div>
                         <div><label className="text-xs opacity-60 mb-1 block">{t.label_month}</label><input type="number" min="1" max="12" value={userData.month} onChange={e => setUserData({...userData, month: parseInt(e.target.value)})} className={`w-full bg-black/20 border ${currentTheme.border} rounded p-3 focus:outline-none focus:border-current`} /></div>
                       </div>
                    </div>

                    <div>
                       <h3 className="text-xl font-bold mb-4 flex items-center gap-2"><Activity className="w-4 h-4"/> {t.step1_ratings_title}</h3>
                       <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                         <RatingControl label={t.label_nipples} icon={<Disc className="w-4 h-4"/>} value={userData.prefs.nipples} onChange={v => handlePrefChange('nipples', v)} />
                         <RatingControl label={t.label_anal} icon={<Eye className="w-4 h-4"/>} value={userData.prefs.anal} onChange={v => handlePrefChange('anal', v)} />
                         <RatingControl label={t.label_urethra} icon={<Droplet className="w-4 h-4"/>} value={userData.prefs.urethra} onChange={v => handlePrefChange('urethra', v)} />
                         <RatingControl label={t.label_pain} icon={<Zap className="w-4 h-4"/>} value={userData.prefs.pain} onChange={v => handlePrefChange('pain', v)} />
                         <RatingControl label={t.label_humiliation} icon={<Ghost className="w-4 h-4"/>} value={userData.prefs.humiliation} onChange={v => handlePrefChange('humiliation', v)} />
                         <RatingControl label={t.label_edging} icon={<Flame className="w-4 h-4"/>} value={userData.prefs.edging} onChange={v => handlePrefChange('edging', v)} />
                         <RatingControl label={t.label_bondage} icon={<Anchor className="w-4 h-4"/>} value={userData.prefs.bondage} onChange={v => handlePrefChange('bondage', v)} />
                         <RatingControl label={t.label_public} icon={<Globe className="w-4 h-4"/>} value={userData.prefs.public} onChange={v => handlePrefChange('public', v)} />
                         <RatingControl label={t.label_service} icon={<Ruler className="w-4 h-4"/>} value={userData.prefs.service} onChange={v => handlePrefChange('service', v)} />
                         <RatingControl label={t.label_sensory} icon={<Headphones className="w-4 h-4"/>} value={userData.prefs.sensory} onChange={v => handlePrefChange('sensory', v)} />
                       </div>
                    </div>

                    <div className={`${currentTheme.card} border ${currentTheme.border} p-6 rounded-lg`}>
                      <h3 className="text-xl font-bold mb-4 flex items-center gap-2"><Palette className="w-4 h-4"/> {t.step1_theme_title}</h3>
                      <div className="grid grid-cols-2 md:grid-cols-5 gap-3">
                        {Object.values(THEMES).map(th => {
                          const btnStyle = { backgroundColor: th.id === 'clinical' || th.id === 'mono' ? '#f1f5f9' : '#1c1917' };
                          return (
                            <button key={th.id} onClick={() => setUserData({...userData, theme: th.id})} className={`p-2 rounded border text-left flex flex-col items-center gap-2 transition-all ${userData.theme === th.id ? `${currentTheme.border} ring-1 ring-offset-2 ring-offset-transparent ring-current` : 'border-transparent opacity-50 hover:opacity-100'}`} style={btnStyle} >
                              <div className={`w-6 h-6 rounded-full ${th.colors.accentBg}`}></div><span className={`text-xs font-bold ${th.id === 'clinical' || th.id === 'mono' ? 'text-slate-800' : 'text-white'}`}>{th.name}</span>
                            </button>
                          );
                        })}
                      </div>
                    </div>

                    <button onClick={generateProtocol} disabled={!userData.name} className={`w-full py-4 ${currentTheme.button} text-white font-bold rounded shadow-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed flex justify-center items-center gap-2 mt-4`}>{t.btn_generate} <ChevronRight className="w-4 h-4"/></button>
                  </div>
                )}

                {step === 2 && (
                  <div className="animate-slide-up relative">
                    <div className={`flex flex-col md:flex-row justify-between items-end mb-6 border-b ${currentTheme.border} pb-4 gap-4`}>
                      <div><h2 className="text-3xl font-black uppercase">{userData.name} {t.step2_title}</h2><div className="flex gap-4 text-sm opacity-60 mt-1 font-mono"><span>{userData.year} / {userData.month}</span><span>Lv: {userData.level.toUpperCase()}</span></div></div>
                      <div className="flex gap-2">
                         <button onClick={() => setStep(1)} className={`p-2 border ${currentTheme.border} opacity-60 hover:opacity-100 rounded`}><RefreshCcw className="w-4 h-4" /></button>
                         <button onClick={downloadImage} disabled={!libLoaded} className={`px-4 py-2 ${currentTheme.card} border ${currentTheme.border} font-bold rounded flex items-center gap-2 text-sm hover:brightness-110 transition-all disabled:opacity-50`}><Download className="w-4 h-4" /> {t.btn_download}</button>
                      </div>
                    </div>

                    <div className="grid grid-cols-7 gap-1 md:gap-3">
                      {['MON', 'TUE', 'WED', 'THU', 'FRI', 'SAT', 'SUN'].map(d => (<div key={d} className="text-center text-xs opacity-40 font-mono py-2">{d}</div>))}
                      {calendar.map((day, idx) => (
                        day.type === 'empty' ? (<div key={`empty-${idx}`} className="hidden md:block"></div>) : (
                          <div key={day.day} onClick={() => setSelectedDay(day)} className={`relative p-2 md:p-3 rounded border transition-all cursor-pointer group flex flex-col min-h-[120px] ${currentTheme.card} ${currentTheme.border} ${currentTheme.cardHover}`}>
                            <div className="absolute -right-4 -bottom-4 w-24 h-24 transform rotate-12 opacity-5 pointer-events-none">{getTaskIcon(day.tags, day.type)}</div>
                            <div className="flex justify-between items-start z-10 mb-2">
                              <span className={`text-lg md:text-xl font-black font-mono ${day.type === 'start' || day.type === 'end' ? currentTheme.accent : 'opacity-40 group-hover:opacity-80'}`}>{String(day.day).padStart(2, '0')}</span>
                              {day.type === 'start' && <Lock className={`w-4 h-4 ${currentTheme.accent}`} />}
                              {day.type === 'end' && <Key className={`w-4 h-4 ${currentTheme.accent}`} />}
                              {day.type === 'check' && <ShieldAlert className="w-4 h-4 text-yellow-600" />}
                            </div>
                            <p className="text-[11px] md:text-xs opacity-70 leading-relaxed z-10 break-words whitespace-normal">{day.task}</p>
                          </div>
                        )
                      ))}
                    </div>

                    {selectedDay && selectedDay.type !== 'empty' && (
                      <div className="fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm p-4" onClick={() => setSelectedDay(null)}>
                        <div className={`${currentTheme.modal} border-2 p-6 rounded-lg max-w-sm w-full shadow-2xl relative ${currentTheme.bg}`} onClick={e => e.stopPropagation()}>
                          <button onClick={() => setSelectedDay(null)} className="absolute top-3 right-3 opacity-50 hover:opacity-100"><XIcon className="w-5 h-5"/></button>
                          <div className="flex justify-center mb-6"><div className={`w-20 h-20 rounded-full bg-black/20 flex items-center justify-center p-4 ${currentTheme.border} border`}>{getTaskIcon(selectedDay.tags, selectedDay.type)}</div></div>
                          <h3 className={`${currentTheme.accent} font-mono text-lg font-bold mb-4 border-b ${currentTheme.border} pb-2 text-center`}>{userData.year}.{userData.month}.{String(selectedDay.day).padStart(2,'0')}</h3>
                          <p className={`text-lg leading-relaxed font-medium ${currentTheme.text} text-center`}>{selectedDay.task}</p>
                        </div>
                      </div>
                    )}
                  </div>
                )}
              </main>

              {/* EXPORT NODE (1920x1080) */}
              <div className="absolute top-0 left-[-9999px]">
                  <div ref={exportRef} className={`w-[1920px] h-[1080px] ${currentTheme.bg} ${currentTheme.text} px-16 py-6 flex flex-col justify-between border-[20px] ${currentTheme.border} relative`}>
                    <div className="absolute inset-0 opacity-10" style={exportBgStyle}></div>
                    
                    {/* Header */}
                    <div className={`flex justify-between items-start border-b-4 ${currentTheme.border} pb-2 z-10`}>
                      <div><h1 className="text-6xl font-black tracking-[0.2em] mb-4">{t.title}</h1><div className="flex gap-8 text-2xl opacity-60 font-mono"><span>SUBJECT: <span className="font-bold opacity-100">{userData.name}</span></span><span>DATE: {userData.year} / {userData.month}</span></div></div>
                      <div className="text-right">
                        <Lock className={`w-20 h-20 ${currentTheme.accent} mb-2`} />
                        <div className="text-xl font-mono opacity-50">{t.subtitle}</div>
                        <div className="text-sm font-mono opacity-40 mt-2">By @ARNO19450</div>
                      </div>
                    </div>

                    {/* Grid Days Header */}
                    <div className="grid grid-cols-7 gap-4 mb-2 mt-2 px-2 opacity-50 font-mono text-lg z-10">{['MON', 'TUE', 'WED', 'THU', 'FRI', 'SAT', 'SUN'].map(d => <div key={d} className="text-center">{d}</div>)}</div>
                    
                    {/* Calendar Grid */}
                    <div className="grid grid-cols-7 gap-x-4 gap-y-2 flex-grow px-2 z-10 content-start">
                      {calendar.map((day, idx) => (
                        day.type === 'empty' ? (<div key={`exp-empty-${idx}`} className="border-transparent"></div>) : (
                          <div key={day.day} className={`border ${currentTheme.border} p-3 relative flex flex-col h-full overflow-hidden ${day.type === 'start' || day.type === 'end' ? 'bg-black/10' : ''}`}>
                            <div className="absolute -right-2 -bottom-2 w-16 h-16 transform rotate-12 opacity-[0.07]">{getTaskIcon(day.tags, day.type)}</div>
                            <span className={`text-2xl font-bold font-mono mb-1 ${day.type === 'check' ? 'text-yellow-500' : 'opacity-40'}`}>{day.day}</span>
                            {/* Adjusted Font Size for readability and fitting */}
                            <p className="text-[15px] leading-tight opacity-90 relative z-10 whitespace-normal break-words font-medium">{day.task}</p>
                          </div>
                        )
                      ))}
                    </div>

                    {/* Footer */}
                    <div className={`flex justify-between items-end border-t ${currentTheme.border} pt-2 z-10`}>
                      <div className="opacity-50 font-mono text-lg w-1/2 whitespace-pre-wrap">{t.footer_sign}</div>
                      <div className="text-right">
                        <div className="text-4xl font-black opacity-80">{t.footer_approve}</div>
                        <div className="text-sm font-mono opacity-40 mt-2">By @ARNO19450</div>
                      </div>
                    </div>
                  </div>
              </div>
            </div>
          );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<LockCalendarPro />);
    </script>
</body>
</html>
